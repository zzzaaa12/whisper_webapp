<?xml version="1.0" encoding="UTF-8"?>
<svg width="1200" height="800" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      .title { font-family: Arial, sans-serif; font-size: 24px; font-weight: bold; fill: #2c3e50; }
      .subtitle { font-family: Arial, sans-serif; font-size: 18px; font-weight: bold; fill: #34495e; }
      .label { font-family: Arial, sans-serif; font-size: 12px; font-weight: bold; fill: #2c3e50; }
      .text { font-family: Arial, sans-serif; font-size: 10px; fill: #34495e; }
      .arrow { stroke: #7f8c8d; stroke-width: 2; fill: none; marker-end: url(#arrowhead); }
      .main-box { fill: #3498db; stroke: #2980b9; stroke-width: 2; }
      .process-box { fill: #e74c3c; stroke: #c0392b; stroke-width: 2; }
      .service-box { fill: #f39c12; stroke: #e67e22; stroke-width: 2; }
      .storage-box { fill: #27ae60; stroke: #229954; stroke-width: 2; }
      .ui-box { fill: #9b59b6; stroke: #8e44ad; stroke-width: 2; }
      .security-box { fill: #e67e22; stroke: #d35400; stroke-width: 2; }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#7f8c8d" />
    </marker>
  </defs>
  
  <!-- 標題 -->
  <text x="600" y="30" text-anchor="middle" class="title">Whisper 語音轉文字系統 - 主要功能架構</text>
  
  <!-- 用戶輸入區域 -->
  <rect x="50" y="60" width="200" height="80" rx="10" class="ui-box"/>
  <text x="150" y="85" text-anchor="middle" class="label">用戶輸入</text>
  <text x="150" y="105" text-anchor="middle" class="text">• YouTube 連結</text>
  <text x="150" y="120" text-anchor="middle" class="text">• Web 介面</text>
  <text x="150" y="135" text-anchor="middle" class="text">• Python Client</text>
  
  <!-- 安全驗證 -->
  <rect x="300" y="60" width="150" height="80" rx="10" class="security-box"/>
  <text x="375" y="85" text-anchor="middle" class="label">安全驗證</text>
  <text x="375" y="105" text-anchor="middle" class="text">• 通行碼驗證</text>
  <text x="375" y="120" text-anchor="middle" class="text">• IP 限制 (5次/5分)</text>
  <text x="375" y="135" text-anchor="middle" class="text">• 管理員介面</text>
  
  <!-- Flask 主應用 -->
  <rect x="500" y="60" width="200" height="80" rx="10" class="main-box"/>
  <text x="600" y="85" text-anchor="middle" class="label">Flask Web Server</text>
  <text x="600" y="105" text-anchor="middle" class="text">• 主應用程式 (app.py)</text>
  <text x="600" y="120" text-anchor="middle" class="text">• Socket.IO 即時通訊</text>
  <text x="600" y="135" text-anchor="middle" class="text">• 背景工作程序</text>
  
  <!-- 背景處理 -->
  <rect x="750" y="60" width="200" height="80" rx="10" class="process-box"/>
  <text x="850" y="85" text-anchor="middle" class="label">背景處理</text>
  <text x="850" y="105" text-anchor="middle" class="text">• Threading 多執行緒</text>
  <text x="850" y="120" text-anchor="middle" class="text">• 任務佇列管理</text>
  <text x="850" y="135" text-anchor="middle" class="text">• 進度回報</text>
  
  <!-- 箭頭連接 -->
  <line x1="250" y1="100" x2="300" y2="100" class="arrow"/>
  <line x1="450" y1="100" x2="500" y2="100" class="arrow"/>
  <line x1="700" y1="100" x2="750" y2="100" class="arrow"/>
  
  <!-- 主要處理流程 -->
  <!-- 1. YouTube 下載 -->
  <rect x="50" y="200" width="180" height="60" rx="8" class="service-box"/>
  <text x="140" y="225" text-anchor="middle" class="label">1. YouTube 音訊下載</text>
  <text x="140" y="240" text-anchor="middle" class="text">yt-dlp 工具</text>
  <text x="140" y="255" text-anchor="middle" class="text">格式轉換</text>
  
  <!-- 2. 音訊處理 -->
  <rect x="250" y="200" width="180" height="60" rx="8" class="process-box"/>
  <text x="340" y="225" text-anchor="middle" class="label">2. 音訊檔案處理</text>
  <text x="340" y="240" text-anchor="middle" class="text">格式正規化</text>
  <text x="340" y="255" text-anchor="middle" class="text">品質檢查</text>
  
  <!-- 3. Whisper 模型 -->
  <rect x="450" y="200" width="180" height="60" rx="8" class="process-box"/>
  <text x="540" y="225" text-anchor="middle" class="label">3. Whisper 模型載入</text>
  <text x="540" y="240" text-anchor="middle" class="text">CUDA/CPU 自動選擇</text>
  <text x="540" y="255" text-anchor="middle" class="text">模型初始化</text>
  
  <!-- 4. 音訊轉錄 -->
  <rect x="650" y="200" width="180" height="60" rx="8" class="process-box"/>
  <text x="740" y="225" text-anchor="middle" class="label">4. 音訊轉錄處理</text>
  <text x="740" y="240" text-anchor="middle" class="text">分段處理</text>
  <text x="740" y="255" text-anchor="middle" class="text">進度回報</text>
  
  <!-- 5. 字幕生成 -->
  <rect x="850" y="200" width="180" height="60" rx="8" class="storage-box"/>
  <text x="940" y="225" text-anchor="middle" class="label">5. 字幕檔案生成</text>
  <text x="940" y="240" text-anchor="middle" class="text">.srt 格式</text>
  <text x="940" y="255" text-anchor="middle" class="text">時間戳記</text>
  
  <!-- 處理流程箭頭 -->
  <line x1="230" y1="230" x2="250" y2="230" class="arrow"/>
  <line x1="430" y1="230" x2="450" y2="230" class="arrow"/>
  <line x1="630" y1="230" x2="650" y2="230" class="arrow"/>
  <line x1="830" y1="230" x2="850" y2="230" class="arrow"/>
  
  <!-- 6. OpenAI 摘要 -->
  <rect x="250" y="300" width="180" height="60" rx="8" class="service-box"/>
  <text x="340" y="325" text-anchor="middle" class="label">6. OpenAI GPT 摘要</text>
  <text x="340" y="340" text-anchor="middle" class="text">結構化摘要</text>
  <text x="340" y="355" text-anchor="middle" class="text">關鍵字提取</text>
  
  <!-- 7. 檔案儲存 -->
  <rect x="450" y="300" width="180" height="60" rx="8" class="storage-box"/>
  <text x="540" y="325" text-anchor="middle" class="label">7. 檔案儲存與清理</text>
  <text x="540" y="340" text-anchor="middle" class="text">摘要存檔</text>
  <text x="540" y="355" text-anchor="middle" class="text">音檔自動刪除</text>
  
  <!-- 8. Telegram 發送 -->
  <rect x="650" y="300" width="180" height="60" rx="8" class="service-box"/>
  <text x="740" y="325" text-anchor="middle" class="label">8. Telegram 發送</text>
  <text x="740" y="340" text-anchor="middle" class="text">完整摘要內容</text>
  <text x="740" y="355" text-anchor="middle" class="text">通知用戶</text>
  
  <!-- 垂直箭頭 -->
  <line x1="340" y1="260" x2="340" y2="300" class="arrow"/>
  <line x1="540" y1="260" x2="540" y2="300" class="arrow"/>
  <line x1="740" y1="260" x2="740" y2="300" class="arrow"/>
  
  <!-- 結果回報 -->
  <rect x="450" y="400" width="180" height="60" rx="8" class="main-box"/>
  <text x="540" y="425" text-anchor="middle" class="label">9. 結果回報給用戶</text>
  <text x="540" y="440" text-anchor="middle" class="text">Web 介面</text>
  <text x="540" y="455" text-anchor="middle" class="text">API 回應</text>
  
  <!-- 最終箭頭 -->
  <line x1="540" y1="360" x2="540" y2="400" class="arrow"/>
  
  <!-- 用戶介面區域 -->
  <rect x="50" y="500" width="300" height="80" rx="10" class="ui-box"/>
  <text x="200" y="525" text-anchor="middle" class="label">用戶介面功能</text>
  <text x="200" y="545" text-anchor="middle" class="text">• 即時操作日誌</text>
  <text x="200" y="560" text-anchor="middle" class="text">• 進度顯示與取消</text>
  <text x="200" y="575" text-anchor="middle" class="text">• 摘要列表與下載</text>
  
  <!-- 檔案儲存區域 -->
  <rect x="400" y="500" width="300" height="80" rx="10" class="storage-box"/>
  <text x="550" y="525" text-anchor="middle" class="label">檔案儲存系統</text>
  <text x="550" y="545" text-anchor="middle" class="text">• 字幕檔案 (.srt)</text>
  <text x="550" y="560" text-anchor="middle" class="text">• 摘要檔案 (.txt)</text>
  <text x="550" y="575" text-anchor="middle" class="text">• 自動清理機制</text>
  
  <!-- 外部服務區域 -->
  <rect x="750" y="500" width="300" height="80" rx="10" class="service-box"/>
  <text x="900" y="525" text-anchor="middle" class="label">外部服務整合</text>
  <text x="900" y="545" text-anchor="middle" class="text">• YouTube 音訊下載</text>
  <text x="900" y="560" text-anchor="middle" class="text">• OpenAI GPT API</text>
  <text x="900" y="575" text-anchor="middle" class="text">• Telegram Bot</text>
  
  <!-- 技術特色區域 -->
  <rect x="50" y="620" width="1000" height="120" rx="10" fill="#ecf0f1" stroke="#bdc3c7" stroke-width="2"/>
  <text x="550" y="645" text-anchor="middle" class="subtitle">系統技術特色</text>
  
  <!-- 左側特色 -->
  <text x="100" y="670" class="label">🔧 多層架構設計</text>
  <text x="100" y="685" class="text">• 前端介面 → API層 → 業務邏輯 → 背景處理</text>
  <text x="100" y="700" class="text">• 模組化設計，職責分離</text>
  
  <text x="100" y="720" class="label">⚡ 即時通訊系統</text>
  <text x="100" y="735" class="text">• Socket.IO 即時狀態更新</text>
  
  <!-- 中間特色 -->
  <text x="400" y="670" class="label">🛡️ 安全防護機制</text>
  <text x="400" y="685" class="text">• IP 限制與通行碼驗證</text>
  <text x="400" y="700" class="text">• 管理員介面監控</text>
  
  <text x="400" y="720" class="label">🔄 自動化管理</text>
  <text x="400" y="735" class="text">• 音檔自動清理</text>
  <text x="400" y="750" class="text">• 狀態管理與錯誤恢復</text>
  
  <!-- 右側特色 -->
  <text x="700" y="670" class="label">🚀 效能優化</text>
  <text x="700" y="685" class="text">• CUDA 加速轉錄</text>
  <text x="700" y="700" class="text">• 背景處理避免阻塞</text>
  
  <text x="700" y="720" class="label">📱 多介面支援</text>
  <text x="700" y="735" class="text">• Web 介面</text>
  <text x="700" y="750" class="text">• Python Client API</text>
  
  <!-- 連接線到用戶介面 -->
  <line x1="540" y1="460" x2="200" y2="500" class="arrow"/>
  <line x1="540" y1="460" x2="550" y2="500" class="arrow"/>
  <line x1="540" y1="460" x2="900" y2="500" class="arrow"/>
  
  <!-- 圖例 -->
  <rect x="50" y="760" width="1000" height="30" fill="#f8f9fa" stroke="#dee2e6" stroke-width="1"/>
  <text x="550" y="780" text-anchor="middle" class="label">圖例說明</text>
  
  <rect x="60" y="765" width="15" height="15" class="main-box"/>
  <text x="80" y="775" class="text">主應用程式</text>
  
  <rect x="150" y="765" width="15" height="15" class="process-box"/>
  <text x="170" y="775" class="text">處理流程</text>
  
  <rect x="240" y="765" width="15" height="15" class="service-box"/>
  <text x="260" y="775" class="text">外部服務</text>
  
  <rect x="330" y="765" width="15" height="15" class="storage-box"/>
  <text x="350" y="775" class="text">檔案儲存</text>
  
  <rect x="420" y="765" width="15" height="15" class="ui-box"/>
  <text x="440" y="775" class="text">用戶介面</text>
  
  <rect x="510" y="765" width="15" height="15" class="security-box"/>
  <text x="530" y="775" class="text">安全機制</text>
</svg> 